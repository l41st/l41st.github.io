import{w as a,r as o,u as e}from"./index.c364c784.js";class n{constructor(r){this.cacheLoaded=a(!1),this.loading=a(!1),this.collection=a([]),this.alert=a(null),this.loadData=async()=>{this.loading.set(!0);try{if(!o(this.cacheLoaded)){const t=JSON.parse(window.localStorage.getItem(this.collectionName));t?.length?this.collection.set(t):await this.reloadData(),this.cacheLoaded.set(!0)}this.alert.set({state:"LOAD DATA SUCCESS",type:"info"}),this.loading.set(!1)}catch{this.alert.set({state:"LOAD DATA FAILED",type:"error"}),this.loading.set(!1)}},this.reloadData=async()=>{this.loading.set(!0),this.cacheLoaded.set(!1);try{const t=(await e.from(this.collectionName).select()).data;this.collection.set(t),window.localStorage.setItem(this.collectionName,JSON.stringify(t)),this.alert.set({state:"RELOAD DATA SUCCESS",type:"info"}),this.cacheLoaded.set(!0),this.loading.set(!1)}catch{this.alert.set({state:"RELOAD DATA FAILED",type:"error"}),this.loading.set(!1)}},this.get=async(t,s=!1)=>{this.loading.set(!0);try{let i;return s?i=(await e.from(this.collectionName).select().eq("id",t)).data.find(l=>l.id===t):i=o(this.collection).find(l=>l.id===t),this.alert.set({state:"GET SUCCESS",type:"info"}),this.loading.set(!1),i}catch{return this.alert.set({state:"GET FAILED",type:"error"}),this.loading.set(!1),null}},this.delete=async t=>{this.loading.set(!0);try{await e.from(this.collectionName).delete().eq("id",t),await this.reloadData(),this.alert.set({state:"DELETE SUCCESS",type:"info"}),this.loading.set(!1)}catch{this.alert.set({state:"DELETE FAILED",type:"error"}),this.loading.set(!1)}},this.update=async(t,s)=>{this.loading.set(!0);try{await e.from(this.collectionName).update(s).eq("id",t),await this.reloadData(),this.alert.set({state:"UPDATE SUCCESS",type:"info"}),this.loading.set(!1)}catch{this.alert.set({state:"UPDATE FAILED",type:"error"}),this.loading.set(!1)}},this.insert=async t=>{this.loading.set(!0);try{await e.from(this.collectionName).insert(t),await this.reloadData(),this.alert.set({state:"INSERT SUCCESS",type:"info"}),this.loading.set(!1)}catch{this.alert.set({state:"INSERT FAILED",type:"error"}),this.loading.set(!1)}},this.collectionName=r}}export{n as S};
